<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bioc="http://bpmn.io/schema/bpmn/biocolor/1.0" xmlns:color="http://www.omg.org/spec/BPMN/non-normative/color/1.0" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_0ebeyk3" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.2.0" modeler:executionPlatform="Camunda Platform" modeler:executionPlatformVersion="7.15.0">
  <bpmn:collaboration id="Collaboration_10bohf8">
    <bpmn:participant id="Participant_0xfey6l" name="БП &#34;Получение платежа&#34;" processRef="paysrv_receivePayment" />
  </bpmn:collaboration>
  <bpmn:process id="paysrv_receivePayment" name="paysrv_receivePayment" isExecutable="true">
    <bpmn:serviceTask id="Activity_19n5rlg" name="Поиск по БИК и Дате исключения в справочнике БИК MDM" camunda:delegateExpression="${mdmDelegate}">
      <bpmn:documentation>дата исключения должна быть пустой</bpmn:documentation>
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="origin">bic</camunda:inputParameter>
          <camunda:inputParameter name="action">list</camunda:inputParameter>
          <camunda:inputParameter name="filterMap">
            <camunda:map>
              <camunda:entry key="bic">${participantBankBic}</camunda:entry>
              <camunda:entry key="exceptionDate" />
            </camunda:map>
          </camunda:inputParameter>
          <camunda:inputParameter name="outputName">mdm_bic</camunda:inputParameter>
          <camunda:inputParameter name="showDetails">1</camunda:inputParameter>
          <camunda:inputParameter name="showRefs">1</camunda:inputParameter>
          <camunda:inputParameter name="size">100</camunda:inputParameter>
          <camunda:outputParameter name="recordsNum1">
            <camunda:script scriptFormat="groovy">def b = execution.getVariable("mdm_bic").size().toString();
execution.setVariable('recordsNum1', b,)
recordsNum1</camunda:script>
          </camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1o1sokh</bpmn:incoming>
      <bpmn:outgoing>Flow_0ja35h2</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_0dpfsqp">
      <bpmn:incoming>Flow_13x7nde</bpmn:incoming>
      <bpmn:outgoing>Flow_1pmvp8i</bpmn:outgoing>
      <bpmn:outgoing>Flow_1o1sokh</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:scriptTask id="Activity_0wxp7ed" name="Присвоение кода ошибки 100" scriptFormat="javascript">
      <bpmn:incoming>Flow_1pmvp8i</bpmn:incoming>
      <bpmn:outgoing>Flow_1w5lmp3</bpmn:outgoing>
      <bpmn:script>execution.setVariable('FLK', '100')
execution.setVariable('dscr', 'Некорректно указаны данные отправителя')</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_1knmuce">
      <bpmn:incoming>Flow_0ja35h2</bpmn:incoming>
      <bpmn:outgoing>Flow_0vitzjq</bpmn:outgoing>
      <bpmn:outgoing>Flow_1mz93oi</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:scriptTask id="Activity_0a9na07" name="Присвоение кода ошибки 101" scriptFormat="javascript">
      <bpmn:incoming>Flow_0vitzjq</bpmn:incoming>
      <bpmn:outgoing>Flow_0n3emp8</bpmn:outgoing>
      <bpmn:script>execution.setVariable('FLK', '101')
execution.setVariable('dscr', 'У отправителя с указанным «БИК» нет прав на взаимодействие')</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:scriptTask id="Activity_1osg2bj" name="Инициализация флага ФЛК" scriptFormat="javascript">
      <bpmn:incoming>Flow_1bu64va</bpmn:incoming>
      <bpmn:outgoing>Flow_1e44b7z</bpmn:outgoing>
      <bpmn:script>execution.setVariable('FLK', '0')
execution.setVariable('dscr', 'Успешно')</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:serviceTask id="Activity_18s72ar" name="Поиск отправителя в MDM  -  активной записи по рег. номеру и БИК" camunda:delegateExpression="${mdmDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="origin">paysrv_banks</camunda:inputParameter>
          <camunda:inputParameter name="action">list</camunda:inputParameter>
          <camunda:inputParameter name="filterMap">
            <camunda:map>
              <camunda:entry key="regNumber">${participantNumber}</camunda:entry>
              <camunda:entry key="bankBic">${participantBankBic}</camunda:entry>
            </camunda:map>
          </camunda:inputParameter>
          <camunda:inputParameter name="showDetails">1</camunda:inputParameter>
          <camunda:inputParameter name="showRefs">1</camunda:inputParameter>
          <camunda:inputParameter name="size">100</camunda:inputParameter>
          <camunda:inputParameter name="outputName">mdm_bank</camunda:inputParameter>
          <camunda:outputParameter name="recordsNum">
            <camunda:script scriptFormat="groovy">def a = execution.getVariable("mdm_bank").size().toString();
execution.setVariable('recordsNum', a)
recordsNum</camunda:script>
          </camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1e44b7z</bpmn:incoming>
      <bpmn:outgoing>Flow_13x7nde</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_010jov0" name="Поиск платежа в MDM" camunda:delegateExpression="${mdmDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="origin">paysrv_payments</camunda:inputParameter>
          <camunda:inputParameter name="action">list</camunda:inputParameter>
          <camunda:inputParameter name="filterMap">
            <camunda:map>
              <camunda:entry key="operationId">${operationId}</camunda:entry>
            </camunda:map>
          </camunda:inputParameter>
          <camunda:inputParameter name="showDetails">1</camunda:inputParameter>
          <camunda:inputParameter name="showRefs">1</camunda:inputParameter>
          <camunda:inputParameter name="size">100</camunda:inputParameter>
          <camunda:inputParameter name="outputName">mdm_payment</camunda:inputParameter>
          <camunda:outputParameter name="mdm_payment">${mdm_payment}</camunda:outputParameter>
          <camunda:outputParameter name="recordsNum2">
            <camunda:script scriptFormat="groovy">def c = execution.getVariable("mdm_payment").size().toString();
execution.setVariable('recordsNum2', c,)
recordsNum2</camunda:script>
          </camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1mz93oi</bpmn:incoming>
      <bpmn:outgoing>Flow_1arvafa</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_0kyejs5">
      <bpmn:incoming>Flow_1arvafa</bpmn:incoming>
      <bpmn:outgoing>Flow_1ibydbe</bpmn:outgoing>
      <bpmn:outgoing>Flow_1lw4tnn</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="Gateway_0geycsd">
      <bpmn:incoming>Flow_1w5lmp3</bpmn:incoming>
      <bpmn:outgoing>Flow_1jmxxf0</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="Gateway_1b67nov">
      <bpmn:incoming>Flow_0n3emp8</bpmn:incoming>
      <bpmn:incoming>Flow_1jmxxf0</bpmn:incoming>
      <bpmn:outgoing>Flow_083xz9p</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:exclusiveGateway id="Gateway_1qeav56">
      <bpmn:incoming>Flow_1lw4tnn</bpmn:incoming>
      <bpmn:outgoing>Flow_1ypfxdu</bpmn:outgoing>
      <bpmn:outgoing>Flow_1557qgb</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:scriptTask id="Activity_1uis3i0" name="Присвоение кода ошибки 300" scriptFormat="javascript">
      <bpmn:incoming>Flow_1557qgb</bpmn:incoming>
      <bpmn:outgoing>Flow_1uhy9ah</bpmn:outgoing>
      <bpmn:script>execution.setVariable('FLK', '300')
execution.setVariable('dscr', 'Некорректно указаны данные уникального идентификатора платежа')</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_0newd62">
      <bpmn:incoming>Flow_083xz9p</bpmn:incoming>
      <bpmn:incoming>Flow_1uhy9ah</bpmn:incoming>
      <bpmn:outgoing>Flow_1v995x5</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:scriptTask id="Activity_0ld5aau" name="Сохранение UUID записи о платеже" scriptFormat="groovy">
      <bpmn:incoming>Flow_1ibydbe</bpmn:incoming>
      <bpmn:outgoing>Flow_101jrjv</bpmn:outgoing>
      <bpmn:script>execution.setVariable("uuidPayment", execution.getVariable("mdm_payment")[0].uuid)</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_10zznu4">
      <bpmn:incoming>Flow_101jrjv</bpmn:incoming>
      <bpmn:outgoing>Flow_0dfzjqc</bpmn:outgoing>
      <bpmn:outgoing>Flow_1psbupi</bpmn:outgoing>
      <bpmn:outgoing>Flow_0yqzi8k</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:scriptTask id="Activity_0714cis" name="Присвоение кода ошибки 300" scriptFormat="javascript">
      <bpmn:incoming>Flow_0dfzjqc</bpmn:incoming>
      <bpmn:outgoing>Flow_0983fme</bpmn:outgoing>
      <bpmn:script>execution.setVariable('FLK', '300')
execution.setVariable('dscr', 'Некорректно указаны данные уникального идентификатора платежа')</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:serviceTask id="Activity_1i39jtq" name="Поиск электронного счета в MDM" camunda:delegateExpression="${mdmDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="origin">paysrv_invoices</camunda:inputParameter>
          <camunda:inputParameter name="action">list</camunda:inputParameter>
          <camunda:inputParameter name="filterMap">
            <camunda:map>
              <camunda:entry key="invoiceNumber">${invoiceId}</camunda:entry>
            </camunda:map>
          </camunda:inputParameter>
          <camunda:inputParameter name="showDetails">1</camunda:inputParameter>
          <camunda:inputParameter name="showRefs">1</camunda:inputParameter>
          <camunda:inputParameter name="size">100</camunda:inputParameter>
          <camunda:inputParameter name="outputName">mdm_invoice</camunda:inputParameter>
          <camunda:outputParameter name="mdm_invoice">${mdm_invoice}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1ypfxdu</bpmn:incoming>
      <bpmn:outgoing>Flow_1qtfc6x</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:scriptTask id="Activity_0k89cbz" name="Получение uuid электронного счета и payerId из MDM" scriptFormat="groovy">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:outputParameter name="payeeId">${payeeId}</camunda:outputParameter>
          <camunda:outputParameter name="payerId">${payerId}</camunda:outputParameter>
          <camunda:outputParameter name="uuidInvoice">${uuidInvoice}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1qtfc6x</bpmn:incoming>
      <bpmn:outgoing>Flow_1rkz8ru</bpmn:outgoing>
      <bpmn:script>def uuidInvoice1 = execution.getVariable("mdm_invoice")
execution.setVariable("uuidInvoice", uuidInvoice1[0].uuid)
uuidInvoice
execution.setVariable('payerId', execution.getVariable('mdm_invoice')[0].payerId);
execution.setVariable('payeeId', execution.getVariable('mdm_invoice')[0].payeeId);</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:scriptTask id="Activity_1s9toh9" name="Обработка данных" scriptFormat="groovy">
      <bpmn:incoming>Flow_0aodnye</bpmn:incoming>
      <bpmn:outgoing>Flow_1bu64va</bpmn:outgoing>
      <bpmn:script>def paymentDateD = Date.parse("yyyy-MM-dd",execution.getVariable("paymentDate"));
execution.setVariable("paymentDateD", paymentDateD);

import java.text.*
TimeZone tz = TimeZone.getTimeZone("UTC");
df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");
df.setTimeZone(tz);
String nowAsISO = df.format(new Date());

execution.setVariable("nowAsISO", nowAsISO);

execution.setVariable("idRq", idRq)

</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:startEvent id="Event_0w7b9r7" name="Выполнен вызов БП  от Адаптера СМЭВ">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="messageID" label="messageID" type="string" />
          <camunda:formField id="messagePrimaryContent" label="messagePrimaryContent" type="string" />
          <camunda:formField id="messageName" label="messageName" type="string" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:outgoing>Flow_0aodnye</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="Flow_1dc0trw" sourceRef="Activity_1m0zchy" targetRef="Activity_0if6psf" />
    <bpmn:sequenceFlow id="Flow_09mvv2h" sourceRef="Activity_0wme3p7" targetRef="Activity_1m0zchy" />
    <bpmn:sequenceFlow id="Flow_1qtfc6x" sourceRef="Activity_1i39jtq" targetRef="Activity_0k89cbz" />
    <bpmn:sequenceFlow id="Flow_1bu64va" sourceRef="Activity_1s9toh9" targetRef="Activity_1osg2bj" />
    <bpmn:sequenceFlow id="Flow_08qwo3f" sourceRef="Gateway_1n57i57" targetRef="Gateway_1mipwbk" />
    <bpmn:sequenceFlow id="Flow_0yqzi8k" name="reason 3" sourceRef="Gateway_10zznu4" targetRef="Activity_027cz2m">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${reason == 3}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_101jrjv" sourceRef="Activity_0ld5aau" targetRef="Gateway_10zznu4" />
    <bpmn:sequenceFlow id="Flow_1psbupi" name="reason 2" sourceRef="Gateway_10zznu4" targetRef="Activity_1h4d4tm">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${reason == 2}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0983fme" sourceRef="Activity_0714cis" targetRef="Gateway_1n57i57" />
    <bpmn:sequenceFlow id="Flow_0dfzjqc" name="reason 1" sourceRef="Gateway_10zznu4" targetRef="Activity_0714cis">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${reason == 1}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1uhy9ah" sourceRef="Activity_1uis3i0" targetRef="Gateway_0newd62" />
    <bpmn:sequenceFlow id="Flow_1v995x5" sourceRef="Gateway_0newd62" targetRef="Gateway_0drlgkx" />
    <bpmn:sequenceFlow id="Flow_1557qgb" name="reason 2 или 3 " sourceRef="Gateway_1qeav56" targetRef="Activity_1uis3i0">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${reason == 2 or reason == 3 } </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1ypfxdu" name="reason 1" sourceRef="Gateway_1qeav56" targetRef="Activity_1i39jtq">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${reason == 1} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1lw4tnn" name="Запись не найдена" sourceRef="Gateway_0kyejs5" targetRef="Gateway_1qeav56">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recordsNum2 == 0} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1ibydbe" name="Запись найдена" sourceRef="Gateway_0kyejs5" targetRef="Activity_0ld5aau">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recordsNum2 != 0} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1arvafa" sourceRef="Activity_010jov0" targetRef="Gateway_0kyejs5" />
    <bpmn:sequenceFlow id="Flow_083xz9p" sourceRef="Gateway_1b67nov" targetRef="Gateway_0newd62" />
    <bpmn:sequenceFlow id="Flow_1mz93oi" name="Запись найдена" sourceRef="Gateway_1knmuce" targetRef="Activity_010jov0">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recordsNum1 != 0} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0aodnye" sourceRef="Event_0w7b9r7" targetRef="Activity_1s9toh9" />
    <bpmn:sequenceFlow id="Flow_1jmxxf0" sourceRef="Gateway_0geycsd" targetRef="Gateway_1b67nov" />
    <bpmn:sequenceFlow id="Flow_0n3emp8" sourceRef="Activity_0a9na07" targetRef="Gateway_1b67nov" />
    <bpmn:sequenceFlow id="Flow_0vitzjq" name="Запись не найдена" sourceRef="Gateway_1knmuce" targetRef="Activity_0a9na07">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recordsNum1 == 0} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0ja35h2" sourceRef="Activity_19n5rlg" targetRef="Gateway_1knmuce" />
    <bpmn:sequenceFlow id="Flow_1w5lmp3" sourceRef="Activity_0wxp7ed" targetRef="Gateway_0geycsd" />
    <bpmn:sequenceFlow id="Flow_1pmvp8i" name="Запись не найдена" sourceRef="Gateway_0dpfsqp" targetRef="Activity_0wxp7ed">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recordsNum == 0} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_13x7nde" sourceRef="Activity_18s72ar" targetRef="Gateway_0dpfsqp" />
    <bpmn:sequenceFlow id="Flow_1e44b7z" sourceRef="Activity_1osg2bj" targetRef="Activity_18s72ar" />
    <bpmn:sequenceFlow id="Flow_1o1sokh" name="Запись найдена" sourceRef="Gateway_0dpfsqp" targetRef="Activity_19n5rlg">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${recordsNum != 0} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1b2h8wn" sourceRef="Gateway_1mipwbk" targetRef="Activity_0b5ct5u" />
    <bpmn:sequenceFlow id="Flow_1qxb1ev" sourceRef="Activity_0b5ct5u" targetRef="Event_0ckc90s" />
    <bpmn:sequenceFlow id="Flow_0g4b2yl" sourceRef="Activity_04cgmrz" targetRef="Activity_02fgr5v" />
    <bpmn:sequenceFlow id="Flow_16bjbli" sourceRef="Activity_02fgr5v" targetRef="Gateway_046subv" />
    <bpmn:sequenceFlow id="Flow_1a8ph68" name="Почтовые адреса есть" sourceRef="Gateway_046subv" targetRef="Activity_0q7xjv7">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${to != null &amp;&amp; to != ""}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_0v0al9s" sourceRef="Activity_0q7xjv7" targetRef="Activity_01b794c" />
    <bpmn:sequenceFlow id="Flow_06ci8n5" sourceRef="Gateway_0drlgkx" targetRef="Gateway_1mipwbk" />
    <bpmn:sequenceFlow id="Flow_09w4qmm" name="Почтовых адресов нет" sourceRef="Gateway_046subv" targetRef="Gateway_0drlgkx">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${to == null || to== ""} </bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_1komp8z" sourceRef="Activity_01b794c" targetRef="Gateway_1mipwbk" />
    <bpmn:sequenceFlow id="Flow_0n04dby" sourceRef="Activity_1h4d4tm" targetRef="Gateway_1n57i57" />
    <bpmn:serviceTask id="Activity_1h4d4tm" name="Заглушка (причина направления 2 не обрабатывается)" camunda:expression="true">
      <bpmn:incoming>Flow_1psbupi</bpmn:incoming>
      <bpmn:outgoing>Flow_0n04dby</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_1cpygnf" sourceRef="Activity_027cz2m" targetRef="Gateway_1n57i57" />
    <bpmn:serviceTask id="Activity_027cz2m" name="Заглушка (причина направления 3 не обрабатывается)" camunda:expression="true">
      <bpmn:incoming>Flow_0yqzi8k</bpmn:incoming>
      <bpmn:outgoing>Flow_1cpygnf</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_1n57i57">
      <bpmn:incoming>Flow_0983fme</bpmn:incoming>
      <bpmn:incoming>Flow_0n04dby</bpmn:incoming>
      <bpmn:incoming>Flow_1cpygnf</bpmn:incoming>
      <bpmn:outgoing>Flow_08qwo3f</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="Activity_04cgmrz" name="Запрос данных Плательщика из MDM" camunda:delegateExpression="${mdmDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="showDetails">4</camunda:inputParameter>
          <camunda:inputParameter name="filterMap">
            <camunda:map>
              <camunda:entry key="uuid">${payerId}</camunda:entry>
            </camunda:map>
          </camunda:inputParameter>
          <camunda:inputParameter name="origin">org</camunda:inputParameter>
          <camunda:inputParameter name="action">list</camunda:inputParameter>
          <camunda:inputParameter name="outputName">mdm_payer</camunda:inputParameter>
          <camunda:outputParameter name="mdm_payer">${mdm_payer}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_11hu31e</bpmn:incoming>
      <bpmn:outgoing>Flow_0g4b2yl</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:scriptTask id="Activity_02fgr5v" name="Данные плательщика" scriptFormat="groovy">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:outputParameter name="to">${to}</camunda:outputParameter>
          <camunda:outputParameter name="emailContact">${execution.getVariable('emailContact')}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0g4b2yl</bpmn:incoming>
      <bpmn:outgoing>Flow_16bjbli</bpmn:outgoing>
      <bpmn:script>def persons = mdm_payer.contactPersons;
def emailContact = ""
def person = persons[0].find{it.position != null &amp;&amp; it.position!="null" &amp;&amp; !it.position.isEmpty()}
execution.setVariable('person', person);
if (person != null) {
	emailContact = person.email
} 


execution.setVariable('emailContact', emailContact);

execution.setVariable('to', emailContact);

execution.setVariable('persons', persons);</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_046subv">
      <bpmn:incoming>Flow_16bjbli</bpmn:incoming>
      <bpmn:outgoing>Flow_1a8ph68</bpmn:outgoing>
      <bpmn:outgoing>Flow_09w4qmm</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:scriptTask id="Activity_0q7xjv7" name="Формирование параметров для почтового уведомления" scriptFormat="groovy">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:outputParameter name="messageText">${messageText}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1a8ph68</bpmn:incoming>
      <bpmn:outgoing>Flow_0v0al9s</bpmn:outgoing>
      <bpmn:script>def messageDate = new Date().format("dd.MM.yyyy");
def messageText = messageDate + ' поступила оплата по электронному счету № ' + execution.getVariable('invoiceId') + '. Сообщение сформировано автоматически. Отвечать на него не требуется.';
execution.setVariable('messageText', messageText);
</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="Gateway_0drlgkx">
      <bpmn:incoming>Flow_1v995x5</bpmn:incoming>
      <bpmn:incoming>Flow_09w4qmm</bpmn:incoming>
      <bpmn:outgoing>Flow_06ci8n5</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:endEvent id="Event_0ckc90s">
      <bpmn:incoming>Flow_1qxb1ev</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:userTask id="Activity_0b5ct5u" camunda:formRef="" camunda:formRefBinding="latest">
      <bpmn:extensionElements>
        <camunda:formData>
          <camunda:formField id="mdmInvoices" type="string" />
        </camunda:formData>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1b2h8wn</bpmn:incoming>
      <bpmn:outgoing>Flow_1qxb1ev</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="Gateway_1mipwbk">
      <bpmn:incoming>Flow_08qwo3f</bpmn:incoming>
      <bpmn:incoming>Flow_06ci8n5</bpmn:incoming>
      <bpmn:incoming>Flow_1komp8z</bpmn:incoming>
      <bpmn:outgoing>Flow_1b2h8wn</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="Activity_01b794c" name="Отправить уведомление на почту" camunda:class="ru.seventech.camunda.serviceTask.EmailNotifyDelegate">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="message">${execution.getVariable('messageText')}</camunda:inputParameter>
          <camunda:inputParameter name="to">${execution.getVariable('to')}</camunda:inputParameter>
          <camunda:inputParameter name="subject">Уведомление об оплате электронного счета</camunda:inputParameter>
          <camunda:inputParameter name="transport_type">email</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_0v0al9s</bpmn:incoming>
      <bpmn:outgoing>Flow_1komp8z</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sendTask id="SendTask_ElectronicInvoicePaid_07ysvex" name="Сообщение об оплате в процесс Проверка статуса оплаты" camunda:delegateExpression="${paysrvPaymentSendMessageDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="messageName">Message_ElectronicInvoicePaid_to_process_paysrv_checkPaymentStatus</camunda:inputParameter>
          <camunda:inputParameter name="uuidInvoice">${uuidInvoice}</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_08wzmw0</bpmn:incoming>
      <bpmn:outgoing>Flow_11hu31e</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:sequenceFlow id="Flow_11hu31e" sourceRef="SendTask_ElectronicInvoicePaid_07ysvex" targetRef="Activity_04cgmrz" />
    <bpmn:sequenceFlow id="Flow_1rkz8ru" sourceRef="Activity_0k89cbz" targetRef="Activity_0wme3p7" />
    <bpmn:serviceTask id="Activity_0wme3p7" name="Создание записи о платеже в МДМ" camunda:delegateExpression="${mdmDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="outputName">result</camunda:inputParameter>
          <camunda:inputParameter name="dataScript">
            <camunda:script scriptFormat="groovy">[
"operationId" : execution.getVariable('operationId'),
"paymentDate" : execution.getVariable('paymentDateD').format("yyyy-MM-dd"),
"invoiceId" : execution.getVariable('uuidInvoice'),
"amount" : execution.getVariable('amount'),
"currency" : execution.getVariable('currency'),
"purpose" : execution.getVariable('purpose'),
"payeeId" : execution.getVariable('payeeId'),
"payeeBankBiC" : execution.getVariable('payeeBankBiC'),
"payeeBankName" : execution.getVariable('payeeBankName'),
"payeeBankAcc" : execution.getVariable('payeeBankAcc'),
"payeeBankCorr" : execution.getVariable('payeeBankCorr'),
"payerId" : execution.getVariable('payerId'),
"payerBankBiC" : execution.getVariable('payerBankBiC'),
"payerBankName" : execution.getVariable('payerBankName'),
"payerBankAcc" : execution.getVariable('payerBankAcc'),
"payerBankCorr" : execution.getVariable('payerBankCorr'),
"paymentStatus": "1",
"regDate": execution.getVariable('nowAsISO'),
"payeeName" : execution.getVariable('payeeName'),
"payeeInn" : execution.getVariable('payeeInn'),
"payeeKpp" : execution.getVariable('payeeKpp'),
"payerName" : execution.getVariable('payerName'),
"payerInn" : execution.getVariable('payerInn'),
"payerKpp" : execution.getVariable('payerKpp'),
]</camunda:script>
          </camunda:inputParameter>
          <camunda:inputParameter name="action">create</camunda:inputParameter>
          <camunda:inputParameter name="origin">paysrv_payments</camunda:inputParameter>
          <camunda:outputParameter name="result">${result}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1rkz8ru</bpmn:incoming>
      <bpmn:outgoing>Flow_09mvv2h</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:scriptTask id="Activity_1m0zchy" name="Получение uuid платежа из MDM" scriptFormat="groovy">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:outputParameter name="uuidPayment">${uuidPayment}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_09mvv2h</bpmn:incoming>
      <bpmn:outgoing>Flow_1dc0trw</bpmn:outgoing>
      <bpmn:script>def uuidPayment = execution.getVariable("result")
execution.setVariable("uuidPayment", uuidPayment.uuid)
uuidPayment</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:serviceTask id="Activity_0if6psf" name="Обновление данных электронного счета в МДМ (статуса)" camunda:delegateExpression="${mdmDelegate}">
      <bpmn:extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="uuid">${uuidInvoice}</camunda:inputParameter>
          <camunda:inputParameter name="outputName">result_updateInvoice</camunda:inputParameter>
          <camunda:inputParameter name="dataScript">
            <camunda:script scriptFormat="groovy">[
"status": "3",
"changeDate": execution.getVariable('nowAsISO'),
"paymentId": execution.getVariable('uuidPayment'),
"amountToPay": 0
]</camunda:script>
          </camunda:inputParameter>
          <camunda:inputParameter name="action">update</camunda:inputParameter>
          <camunda:inputParameter name="origin">paysrv_invoices</camunda:inputParameter>
          <camunda:outputParameter name="result_updateInvoice">${result_updateInvoice}</camunda:outputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1dc0trw</bpmn:incoming>
      <bpmn:outgoing>Flow_08wzmw0</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_08wzmw0" sourceRef="Activity_0if6psf" targetRef="SendTask_ElectronicInvoicePaid_07ysvex" />
  </bpmn:process>
  <bpmn:message id="Message_1xf2zv9" name="PaySysChargeRequestMessage" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_10bohf8">
      <bpmndi:BPMNShape id="Participant_0xfey6l_di" bpmnElement="Participant_0xfey6l" isHorizontal="true">
        <dc:Bounds x="160" y="80" width="4250" height="830" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_11hu31e_di" bpmnElement="Flow_11hu31e">
        <di:waypoint x="2990" y="550" />
        <di:waypoint x="3060" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1cpygnf_di" bpmnElement="Flow_1cpygnf">
        <di:waypoint x="2290" y="420" />
        <di:waypoint x="2740" y="420" />
        <di:waypoint x="2740" y="315" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0n04dby_di" bpmnElement="Flow_0n04dby">
        <di:waypoint x="2290" y="290" />
        <di:waypoint x="2715" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1komp8z_di" bpmnElement="Flow_1komp8z">
        <di:waypoint x="3930" y="550" />
        <di:waypoint x="4075" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_09w4qmm_di" bpmnElement="Flow_09w4qmm">
        <di:waypoint x="3470" y="575" />
        <di:waypoint x="3470" y="785" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3398" y="656" width="64" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_06ci8n5_di" bpmnElement="Flow_06ci8n5">
        <di:waypoint x="3495" y="810" />
        <di:waypoint x="4100" y="810" />
        <di:waypoint x="4100" y="575" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0v0al9s_di" bpmnElement="Flow_0v0al9s">
        <di:waypoint x="3690" y="550" />
        <di:waypoint x="3830" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1a8ph68_di" bpmnElement="Flow_1a8ph68">
        <di:waypoint x="3495" y="550" />
        <di:waypoint x="3590" y="550" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="3498" y="526" width="90" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_16bjbli_di" bpmnElement="Flow_16bjbli">
        <di:waypoint x="3350" y="550" />
        <di:waypoint x="3445" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0g4b2yl_di" bpmnElement="Flow_0g4b2yl">
        <di:waypoint x="3160" y="550" />
        <di:waypoint x="3250" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1qxb1ev_di" bpmnElement="Flow_1qxb1ev">
        <di:waypoint x="4290" y="550" />
        <di:waypoint x="4342" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1b2h8wn_di" bpmnElement="Flow_1b2h8wn">
        <di:waypoint x="4125" y="550" />
        <di:waypoint x="4190" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1o1sokh_di" bpmnElement="Flow_1o1sokh">
        <di:waypoint x="1035" y="510" />
        <di:waypoint x="1160" y="510" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1057" y="492" width="83" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1e44b7z_di" bpmnElement="Flow_1e44b7z">
        <di:waypoint x="650" y="510" />
        <di:waypoint x="710" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_13x7nde_di" bpmnElement="Flow_13x7nde">
        <di:waypoint x="810" y="510" />
        <di:waypoint x="985" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1pmvp8i_di" bpmnElement="Flow_1pmvp8i">
        <di:waypoint x="1010" y="535" />
        <di:waypoint x="1010" y="580" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="951" y="535" width="52" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1w5lmp3_di" bpmnElement="Flow_1w5lmp3">
        <di:waypoint x="1010" y="660" />
        <di:waypoint x="1010" y="785" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0ja35h2_di" bpmnElement="Flow_0ja35h2">
        <di:waypoint x="1260" y="510" />
        <di:waypoint x="1405" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0vitzjq_di" bpmnElement="Flow_0vitzjq">
        <di:waypoint x="1430" y="535" />
        <di:waypoint x="1430" y="580" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1369" y="546" width="52" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0n3emp8_di" bpmnElement="Flow_0n3emp8">
        <di:waypoint x="1430" y="660" />
        <di:waypoint x="1430" y="785" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1jmxxf0_di" bpmnElement="Flow_1jmxxf0">
        <di:waypoint x="1035" y="810" />
        <di:waypoint x="1405" y="810" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0aodnye_di" bpmnElement="Flow_0aodnye">
        <di:waypoint x="258" y="510" />
        <di:waypoint x="340" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1mz93oi_di" bpmnElement="Flow_1mz93oi">
        <di:waypoint x="1455" y="510" />
        <di:waypoint x="1540" y="510" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1449" y="483" width="83" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_083xz9p_di" bpmnElement="Flow_083xz9p">
        <di:waypoint x="1455" y="810" />
        <di:waypoint x="1865" y="810" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1arvafa_di" bpmnElement="Flow_1arvafa">
        <di:waypoint x="1640" y="510" />
        <di:waypoint x="1715" y="510" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1741" y="242" width="83" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ibydbe_di" bpmnElement="Flow_1ibydbe">
        <di:waypoint x="1740" y="485" />
        <di:waypoint x="1740" y="290" />
        <di:waypoint x="1860" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1741" y="268" width="83" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1lw4tnn_di" bpmnElement="Flow_1lw4tnn">
        <di:waypoint x="1740" y="535" />
        <di:waypoint x="1740" y="550" />
        <di:waypoint x="1865" y="550" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1776" y="516" width="52" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ypfxdu_di" bpmnElement="Flow_1ypfxdu">
        <di:waypoint x="1915" y="550" />
        <di:waypoint x="2010" y="550" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1916" y="533" width="43" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1557qgb_di" bpmnElement="Flow_1557qgb">
        <di:waypoint x="1890" y="575" />
        <di:waypoint x="1890" y="630" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1803" y="593" width="74" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1v995x5_di" bpmnElement="Flow_1v995x5">
        <di:waypoint x="1915" y="810" />
        <di:waypoint x="3445" y="810" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1uhy9ah_di" bpmnElement="Flow_1uhy9ah">
        <di:waypoint x="1890" y="710" />
        <di:waypoint x="1890" y="785" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0dfzjqc_di" bpmnElement="Flow_0dfzjqc">
        <di:waypoint x="2060" y="265" />
        <di:waypoint x="2060" y="200" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2069" y="233" width="43" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0983fme_di" bpmnElement="Flow_0983fme">
        <di:waypoint x="2110" y="160" />
        <di:waypoint x="2740" y="160" />
        <di:waypoint x="2740" y="265" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1psbupi_di" bpmnElement="Flow_1psbupi">
        <di:waypoint x="2085" y="290" />
        <di:waypoint x="2190" y="290" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2088" y="273" width="43" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_101jrjv_di" bpmnElement="Flow_101jrjv">
        <di:waypoint x="1960" y="290" />
        <di:waypoint x="2035" y="290" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0yqzi8k_di" bpmnElement="Flow_0yqzi8k">
        <di:waypoint x="2060" y="315" />
        <di:waypoint x="2060" y="420" />
        <di:waypoint x="2190" y="420" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="2069" y="403" width="43" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_08qwo3f_di" bpmnElement="Flow_08qwo3f">
        <di:waypoint x="2765" y="290" />
        <di:waypoint x="4100" y="290" />
        <di:waypoint x="4100" y="525" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1bu64va_di" bpmnElement="Flow_1bu64va">
        <di:waypoint x="440" y="510" />
        <di:waypoint x="550" y="510" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1qtfc6x_di" bpmnElement="Flow_1qtfc6x">
        <di:waypoint x="2110" y="550" />
        <di:waypoint x="2190" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_09mvv2h_di" bpmnElement="Flow_09mvv2h">
        <di:waypoint x="2470" y="550" />
        <di:waypoint x="2550" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1dc0trw_di" bpmnElement="Flow_1dc0trw">
        <di:waypoint x="2650" y="550" />
        <di:waypoint x="2710" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1rkz8ru_di" bpmnElement="Flow_1rkz8ru">
        <di:waypoint x="2290" y="550" />
        <di:waypoint x="2370" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_08wzmw0_di" bpmnElement="Flow_08wzmw0">
        <di:waypoint x="2810" y="550" />
        <di:waypoint x="2890" y="550" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Activity_19n5rlg_di" bpmnElement="Activity_19n5rlg">
        <dc:Bounds x="1160" y="470" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0dpfsqp_di" bpmnElement="Gateway_0dpfsqp" isMarkerVisible="true">
        <dc:Bounds x="985" y="485" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0wxp7ed_di" bpmnElement="Activity_0wxp7ed">
        <dc:Bounds x="960" y="580" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1knmuce_di" bpmnElement="Gateway_1knmuce" isMarkerVisible="true">
        <dc:Bounds x="1405" y="485" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0a9na07_di" bpmnElement="Activity_0a9na07">
        <dc:Bounds x="1380" y="580" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1osg2bj_di" bpmnElement="Activity_1osg2bj">
        <dc:Bounds x="550" y="470" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_18s72ar_di" bpmnElement="Activity_18s72ar">
        <dc:Bounds x="710" y="470" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_010jov0_di" bpmnElement="Activity_010jov0" bioc:stroke="#000000" bioc:fill="#ffffff" color:background-color="#ffffff" color:border-color="#000000">
        <dc:Bounds x="1540" y="470" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0kyejs5_di" bpmnElement="Gateway_0kyejs5" isMarkerVisible="true">
        <dc:Bounds x="1715" y="485" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0geycsd_di" bpmnElement="Gateway_0geycsd" isMarkerVisible="true">
        <dc:Bounds x="985" y="785" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1b67nov_di" bpmnElement="Gateway_1b67nov" isMarkerVisible="true">
        <dc:Bounds x="1405" y="785" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1qeav56_di" bpmnElement="Gateway_1qeav56" isMarkerVisible="true">
        <dc:Bounds x="1865" y="525" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1uis3i0_di" bpmnElement="Activity_1uis3i0">
        <dc:Bounds x="1840" y="630" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0newd62_di" bpmnElement="Gateway_0newd62" isMarkerVisible="true">
        <dc:Bounds x="1865" y="785" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0ld5aau_di" bpmnElement="Activity_0ld5aau">
        <dc:Bounds x="1860" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_10zznu4_di" bpmnElement="Gateway_10zznu4" isMarkerVisible="true">
        <dc:Bounds x="2035" y="265" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0714cis_di" bpmnElement="Activity_0714cis">
        <dc:Bounds x="2010" y="120" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1i39jtq_di" bpmnElement="Activity_1i39jtq" bioc:stroke="#000000" bioc:fill="#ffffff" color:background-color="#ffffff" color:border-color="#000000">
        <dc:Bounds x="2010" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0k89cbz_di" bpmnElement="Activity_0k89cbz">
        <dc:Bounds x="2190" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1s9toh9_di" bpmnElement="Activity_1s9toh9">
        <dc:Bounds x="340" y="470" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_147jnu1_di" bpmnElement="Event_0w7b9r7">
        <dc:Bounds x="222" y="492" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="199" y="535" width="86" height="53" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1v4rbyh_di" bpmnElement="Activity_1h4d4tm">
        <dc:Bounds x="2190" y="250" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0y540bu_di" bpmnElement="Activity_027cz2m">
        <dc:Bounds x="2190" y="380" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1n57i57_di" bpmnElement="Gateway_1n57i57" isMarkerVisible="true">
        <dc:Bounds x="2715" y="265" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_04cgmrz_di" bpmnElement="Activity_04cgmrz">
        <dc:Bounds x="3060" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_02fgr5v_di" bpmnElement="Activity_02fgr5v">
        <dc:Bounds x="3250" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_046subv_di" bpmnElement="Gateway_046subv" isMarkerVisible="true">
        <dc:Bounds x="3445" y="525" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0q7xjv7_di" bpmnElement="Activity_0q7xjv7">
        <dc:Bounds x="3590" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0drlgkx_di" bpmnElement="Gateway_0drlgkx" isMarkerVisible="true">
        <dc:Bounds x="3445" y="785" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0ckc90s_di" bpmnElement="Event_0ckc90s">
        <dc:Bounds x="4342" y="532" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0b5ct5u_di" bpmnElement="Activity_0b5ct5u">
        <dc:Bounds x="4190" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_1mipwbk_di" bpmnElement="Gateway_1mipwbk" isMarkerVisible="true">
        <dc:Bounds x="4075" y="525" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_01b794c_di" bpmnElement="Activity_01b794c">
        <dc:Bounds x="3830" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1b3ojyd_di" bpmnElement="SendTask_ElectronicInvoicePaid_07ysvex">
        <dc:Bounds x="2890" y="510" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0wme3p7_di" bpmnElement="Activity_0wme3p7">
        <dc:Bounds x="2370" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1m0zchy_di" bpmnElement="Activity_1m0zchy">
        <dc:Bounds x="2550" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0if6psf_di" bpmnElement="Activity_0if6psf">
        <dc:Bounds x="2710" y="510" width="100" height="80" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
